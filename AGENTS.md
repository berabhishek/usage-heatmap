# Repository Guidelines

## Project Structure & Module Organization
- `src/`: TypeScript source for the VS Code extension (entry: `extension.ts`; modules like `heatmap.ts`, `git.ts`, `decorations.ts`).
- `out/`: Compiled JavaScript output (generated by `tsc`). Do not edit.
- `images/`: Extension assets (e.g., `logo.png`).
- `.github/`: Repository meta (PR template).
- `.githooks/`: Local Git hooks (pre-commit checks).

## Architecture Overview
- `extension.ts`: Activates the extension, reads settings, orchestrates git reads and UI updates, and caches per-doc counts for snappy selection updates.
- `git.ts`: Thin wrapper around `simple-git`; resolves repo context/HEAD and computes per-line change counts via `git log -L` (with caching per file+HEAD).
- `heatmap.ts`: Maps counts to color bins (linear/log/exponential) and applies whole-line background decorations; manages decoration lifecycles.
- `decorations.ts`: Builds inline info decorations (e.g., `(X changes)`) and clears editor decorations safely.
- `config.ts`/`constants.ts`: Centralizes config keys, theme colors, and read/update helpers.
- `cache.ts`: In-memory caches for document counts and cache-key helpers.
- `debounce.ts`: Minimal debounce utility for UI-triggered actions.

## Build, Test, and Development Commands
- Install: `pnpm install`
- Build: `pnpm run compile` (TypeScript to `out/`).
- Watch: `pnpm run watch` (incremental rebuild on save).
- Lint: `pnpm run lint` (ESLint on `src/**/*.ts`).
- Type-check: `pnpm run typecheck` (`tsc --noEmit`).
- Test: `pnpm test` (VS Code extension tests; set up when tests exist).
- Package: `pnpm run package` (build VSIX via `vsce`).
- Hooks: `pnpm run setup:hooks` (enable `.githooks` as Git hooks path).

Tip: To run the extension locally, open in VS Code and press F5 (Extension Development Host).

## Coding Style & Naming Conventions
- Language: TypeScript.
- Linting: ESLint (`.eslintrc.json`) enforces `curly`, `eqeqeq`, and TypeScript-friendly semicolons.
- Match existing style in `src/` (2-space indent typical). Run `pnpm run lint` before committing.
- Naming: `camelCase` for variables/functions, `PascalCase` for classes/types, `UPPER_SNAKE_CASE` for immutable constants. Filenames: lowercase (e.g., `heatmap.ts`).

## Testing Guidelines
- Approach: Add lightweight unit/integration tests for core modules (`src/test/**/*.test.ts`).
- Execution: `pnpm test`. Ensure code compiles first (`pnpm run compile`).
- Coverage: Prefer tests for parsing, color scaling, git I/O boundaries, and decoration rendering logic.

## Commit & Pull Request Guidelines
- Commits: Follow Conventional Commits (e.g., `feat:`, `fix:`, `refactor:`; scopes like `feat(heatmap): ...`).
- Pre-commit: Hooks run lint and type-check; you can trigger manually with `pnpm run precommit:check`.
- PRs: Use the PR template. Include a concise summary, bullet list of changes, test steps, and screenshots if UI/visuals change. Link related issues (e.g., `Closes #123`).
